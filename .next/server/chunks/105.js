exports.id=105,exports.ids=[105],exports.modules={7976:()=>{},4426:(e,r,s)=>{Promise.resolve().then(s.bind(s,9590))},184:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},9902:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,9404,23))},9590:(e,r,s)=>{"use strict";s.d(r,{MachineForm:()=>u});var a=s(326),t=s(4723),n=s(4064),i=s(5047),o=s(7577),l=s(7254),d=s(4231),m=s(3679),c=s(4948);function u({machine:e,mode:r}){let s=(0,i.useRouter)(),[u,p]=(0,o.useState)(!1),[x,h]=(0,o.useState)(""),[y,v]=(0,o.useState)([]),[f,g]=(0,o.useState)(""),[b,N]=(0,o.useState)(!1),{register:L,handleSubmit:j,formState:{errors:q},setValue:C,watch:R}=(0,t.cI)({resolver:(0,n.F)(l.c5),defaultValues:e?{numeroOL:e.numeroOL,type:e.type,clientId:e.clientId}:void 0}),M=R("clientId"),O=async a=>{p(!0),h("");try{let t="create"===r?"/api/machines":`/api/machines/${e?.id}`,n=await fetch(t,{method:"create"===r?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){let e=await n.json();throw Error(e.error||"Une erreur est survenue")}s.push("/machines"),s.refresh()}catch(e){h(e instanceof Error?e.message:"Une erreur est survenue")}finally{p(!1)}},A=y.find(e=>e.id===M);return(0,a.jsxs)("form",{onSubmit:j(O),noValidate:!0,className:"space-y-6 max-w-2xl",children:[x&&a.jsx(c.B,{children:x}),a.jsx(d.I,{label:"Num\xe9ro OL",...L("numeroOL"),error:q.numeroOL?.message,placeholder:"OL-12345",disabled:u}),a.jsx(d.I,{label:"Type de machine",...L("type"),error:q.type?.message,placeholder:"CNC Lathe, CNC Mill, etc.",disabled:u}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Client"}),a.jsx("input",{type:"text",placeholder:"Rechercher un client...",value:f,onChange:e=>g(e.target.value),className:"input-field mb-2",disabled:u}),a.jsx("select",{...L("clientId"),disabled:u,className:"input-field",size:8,children:y.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.companyName," - ",e.address]},e.id))}),q.clientId&&a.jsx("p",{className:"mt-1 text-sm text-error-600",children:q.clientId.message}),A&&(0,a.jsxs)("div",{className:"mt-2 p-3 bg-secondary-50 rounded border border-secondary-200",children:[a.jsx("p",{className:"text-sm font-medium text-secondary-900",children:A.companyName}),a.jsx("p",{className:"text-sm text-secondary-600",children:A.address}),(0,a.jsxs)("p",{className:"text-sm text-secondary-600",children:[A.province," ",A.postalCode]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[a.jsx(m.z,{type:"submit",disabled:u,children:u?"Enregistrement...":"create"===r?"Cr\xe9er la machine":"Enregistrer"}),a.jsx(m.z,{type:"button",variant:"secondary",onClick:()=>s.push("/machines"),disabled:u,children:"Annuler"})]})]})}},3679:(e,r,s)=>{"use strict";s.d(r,{z:()=>t});var a=s(326);s(7577);let t=({variant:e="primary",size:r="md",isLoading:s=!1,children:t,className:n="",disabled:i,...o})=>a.jsx("button",{className:`font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500 disabled:bg-primary-300",secondary:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 focus:ring-secondary-400 disabled:bg-secondary-100",danger:"bg-error-600 hover:bg-error-700 text-white focus:ring-error-500 disabled:bg-error-300"}[e]} ${{sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[r]} ${n}`,disabled:i||s,...o,children:s?"Chargement...":t})},4948:(e,r,s)=>{"use strict";s.d(r,{B:()=>t});var a=s(326);s(7577);let t=({children:e,className:r=""})=>e?a.jsx("div",{className:`bg-error-50 border border-error-200 text-error-700 px-4 py-3 rounded-md ${r}`,role:"alert",children:a.jsx("p",{className:"text-sm",children:e})}):null},4231:(e,r,s)=>{"use strict";s.d(r,{I:()=>n});var a=s(326),t=s(7577);let n=s.n(t)().forwardRef(({label:e,error:r,className:s="",id:t,...n},i)=>{let o=t||`input-${e?.replace(/\s+/g,"-").toLowerCase()}`;return(0,a.jsxs)("div",{className:"w-full",children:[e&&a.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-secondary-700 mb-1",children:e}),a.jsx("input",{ref:i,id:o,className:`input-field ${r?"border-error-500 focus:ring-error-500":""} ${s}`,...n}),r&&a.jsx("p",{className:"mt-1 text-sm text-error-600",role:"alert",children:r})]})});n.displayName="Input"},7254:(e,r,s)=>{"use strict";s.d(r,{Lf:()=>d,dm:()=>o,c5:()=>l,J6:()=>n,gV:()=>i});var a=s(9969);let t={password:{required:"Le mot de passe est requis",minLength:"Le mot de passe doit contenir au moins 8 caract\xe8res",maxLength:"Le mot de passe ne peut pas d\xe9passer 128 caract\xe8res"},user:{usernameRequired:"Le nom d'utilisateur est requis",usernameMin:"Le nom d'utilisateur doit contenir au moins 3 caract\xe8res",usernameMax:"Le nom d'utilisateur ne peut pas d\xe9passer 50 caract\xe8res",usernameFormat:"Le nom d'utilisateur ne peut contenir que des lettres minuscules, chiffres, points, traits d'union et underscores",nameRequired:"Le nom complet est requis",nameMax:"Le nom ne peut pas d\xe9passer 100 caract\xe8res",emailRequired:"Le courriel est requis",emailInvalid:"Adresse courriel invalide",emailMax:"Le courriel ne peut pas d\xe9passer 100 caract\xe8res",roleRequired:"Le r\xf4le est requis",roleInvalid:"R\xf4le invalide. Choisir: Admin, Contr\xf4leur ou Utilisateur",duplicateUsername:e=>`Le nom d'utilisateur "${e}" est d\xe9j\xe0 utilis\xe9. Veuillez en choisir un autre.`,duplicateEmail:e=>`Le courriel "${e}" est d\xe9j\xe0 utilis\xe9. Veuillez en choisir un autre.`},machine:{numeroOLRequired:"Le num\xe9ro #OL est requis",numeroOLMax:"Le num\xe9ro #OL ne peut pas d\xe9passer 50 caract\xe8res",numeroOLFormat:"Le num\xe9ro #OL ne peut contenir que des lettres majuscules, chiffres et tirets",duplicateOL:e=>`Le num\xe9ro #OL "${e}" existe d\xe9j\xe0`,typeRequired:"Le type de machine est requis",typeMax:"Le type ne peut pas d\xe9passer 200 caract\xe8res",clientRequired:"Le client est requis",clientInvalid:"Client invalide"},client:{companyNameRequired:"Le nom de l'entreprise est requis",companyNameMax:"Le nom de l'entreprise ne peut pas d\xe9passer 200 caract\xe8res",addressRequired:"L'adresse est requise",addressMax:"L'adresse ne peut pas d\xe9passer 300 caract\xe8res",provinceRequired:"La province est requise",provinceInvalid:"Province invalide",postalCodeRequired:"Le code postal est requis",postalCodeFormat:"Format de code postal invalide (A1A 1A1 ou A1A1A1)",hasMatches:e=>`Ce client a ${e} machine(s) associ\xe9e(s). Veuillez d'abord supprimer ou r\xe9assigner les machines.`}},n=a.Ryn({username:a.Z_8().min(3,t.user.usernameMin).max(50,t.user.usernameMax).regex(/^[a-z0-9._-]+$/,t.user.usernameFormat),email:a.Z_8().min(1,t.user.emailRequired).email(t.user.emailInvalid).max(100,t.user.emailMax),name:a.Z_8().min(1,t.user.nameRequired).max(100,t.user.nameMax),password:a.Z_8().min(8,t.password.minLength).max(128,t.password.maxLength),role:a.KmV(["Admin","Contr\xf4leur","Utilisateur"],{message:t.user.roleInvalid}),isActive:a.O72().default(!0)}),i=a.Ryn({username:a.Z_8().min(3,t.user.usernameMin).max(50,t.user.usernameMax).regex(/^[a-z0-9._-]+$/,t.user.usernameFormat).optional(),email:a.Z_8().email(t.user.emailInvalid).max(100,t.user.emailMax).optional(),name:a.Z_8().min(1,t.user.nameRequired).max(100,t.user.nameMax).optional(),password:a.Z_8().min(8,t.password.minLength).max(128,t.password.maxLength).optional(),role:a.KmV(["Admin","Contr\xf4leur","Utilisateur"],{message:t.user.roleInvalid}).optional(),isActive:a.O72().optional()}),o=a.Ryn({username:a.Z_8().min(1,"Le nom d'utilisateur ou courriel est requis"),password:a.Z_8().min(1,t.password.required)}),l=a.Ryn({numeroOL:a.Z_8().min(1,t.machine.numeroOLRequired).max(50,t.machine.numeroOLMax).regex(/^[A-Z0-9-]+$/,t.machine.numeroOLFormat),type:a.Z_8().min(1,t.machine.typeRequired).max(200,t.machine.typeMax),clientId:a.Z_8().uuid(t.machine.clientInvalid)});a.Ryn({numeroOL:a.Z_8().min(1,t.machine.numeroOLRequired).max(50,t.machine.numeroOLMax).regex(/^[A-Z0-9-]+$/,t.machine.numeroOLFormat).optional(),type:a.Z_8().min(1,t.machine.typeRequired).max(200,t.machine.typeMax).optional(),clientId:a.Z_8().uuid(t.machine.clientInvalid).optional()});let d=a.Ryn({companyName:a.Z_8().min(1,t.client.companyNameRequired).max(200,t.client.companyNameMax),address:a.Z_8().min(1,t.client.addressRequired).max(300,t.client.addressMax),province:a.KmV(["QC","ON","AB","BC","MB","NB","NL","NT","NS","NU","PE","SK","YT"],{message:t.client.provinceInvalid}),postalCode:a.Z_8().regex(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,t.client.postalCodeFormat).transform(e=>e.replace(/[ -]/g,"").toUpperCase())});a.Ryn({companyName:a.Z_8().min(1,t.client.companyNameRequired).max(200,t.client.companyNameMax).optional(),address:a.Z_8().min(1,t.client.addressRequired).max(300,t.client.addressMax).optional(),province:a.KmV(["QC","ON","AB","BC","MB","NB","NL","NT","NS","NU","PE","SK","YT"],{message:t.client.provinceInvalid}).optional(),postalCode:a.Z_8().regex(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,t.client.postalCodeFormat).transform(e=>e.replace(/[ -]/g,"").toUpperCase()).optional()})},7210:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>o});var a=s(9510),t=s(8585),n=s(7371),i=s(1375);async function o({children:e}){let r=await (0,i.Gg)();r||(0,t.redirect)("/login");let s="Admin"===r.role;return"Admin"===r.role||r.role,(0,a.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b border-secondary-200",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{children:[a.jsx(n.default,{href:"/",className:"text-2xl font-bold text-primary-700 hover:text-primary-800",children:"Huron Portal"}),(0,a.jsxs)("p",{className:"text-sm text-secondary-600",children:["Bienvenue, ",r.username," (",r.role,")"]})]}),a.jsx("form",{action:"/api/auth/logout",method:"POST",children:a.jsx("button",{type:"submit",className:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 font-medium py-2 px-4 rounded-md transition-colors",children:"D\xe9connexion"})})]}),(0,a.jsxs)("nav",{className:"flex space-x-8 border-t border-secondary-200 pt-4 pb-4",children:[a.jsx(n.default,{href:"/",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Tableau de bord"}),a.jsx(n.default,{href:"/machines",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Machines"}),a.jsx(n.default,{href:"/clients",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Clients"}),s&&a.jsx(n.default,{href:"/users",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Utilisateurs"})]})]})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})]})}},1506:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>n,metadata:()=>t});var a=s(9510);s(7272);let t={title:"Huron Portal - Gestion des Machines CNC",description:"Syst\xe8me de gestion des machines CNC pour Huron"};function n({children:e}){return a.jsx("html",{lang:"fr",children:a.jsx("body",{className:"antialiased bg-secondary-50 text-secondary-900",children:e})})}},8256:(e,r,s)=>{"use strict";s.d(r,{i:()=>a});let a=(0,s(8570).createProxy)(String.raw`C:\GIT\HuronPortal\components\forms\MachineForm.tsx#MachineForm`)},1375:(e,r,s)=>{"use strict";s.d(r,{Gg:()=>u,Rf:()=>x,Uj:()=>p,ed:()=>d,v6:()=>c});var a=s(6890),t=s(1463),n=s(1615);let i=new TextEncoder().encode(process.env.SESSION_SECRET||"development-secret-key-change-in-production"),o=Number(process.env.SESSION_DURATION)||3600,l="session";async function d(e,r,s){let t=Math.floor(Date.now()/1e3),n=t+o;return await new a.N({userId:e,username:r,role:s,createdAt:t,expiresAt:n}).setProtectedHeader({alg:"HS256"}).setIssuedAt(t).setExpirationTime(n).sign(i)}async function m(e){try{let{payload:r}=await (0,t._)(e,i),s=Math.floor(Date.now()/1e3);if(r.expiresAt&&"number"==typeof r.expiresAt&&r.expiresAt<s)return null;return r}catch(e){return null}}async function c(e){let r=e.cookies.get(l)?.value;return r?m(r):null}async function u(){let e=await (0,n.cookies)(),r=e.get(l)?.value;return r?m(r):null}function p(e){return{name:l,value:e,httpOnly:!0,secure:!0,sameSite:"lax",maxAge:o,path:"/"}}function x(){return{name:l,value:"",httpOnly:!0,secure:!0,sameSite:"lax",maxAge:0,path:"/"}}},7272:()=>{}};