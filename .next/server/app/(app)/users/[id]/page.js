"use strict";(()=>{var e={};e.id=935,e.ids=[935],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{e.exports=require("assert")},9714:e=>{e.exports=require("constants")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},4175:e=>{e.exports=require("tty")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},6005:e=>{e.exports=require("node:crypto")},8849:e=>{e.exports=require("node:http")},2286:e=>{e.exports=require("node:https")},612:e=>{e.exports=require("node:os")},7742:e=>{e.exports=require("node:process")},4492:e=>{e.exports=require("node:stream")},7261:e=>{e.exports=require("node:util")},5628:e=>{e.exports=require("node:zlib")},1627:(e,r,t)=>{t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>m,tree:()=>l}),t(6274),t(7210),t(5866),t(1506);var s=t(3191),n=t(8716),i=t(7922),a=t.n(i),o=t(5231),u={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(u[e]=()=>o[e]);t.d(r,u);let l=["",{children:["(app)",{children:["users",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6274)),"C:\\GIT\\HuronPortal\\app\\(app)\\users\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7210)),"C:\\GIT\\HuronPortal\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"C:\\GIT\\HuronPortal\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\GIT\\HuronPortal\\app\\(app)\\users\\[id]\\page.tsx"],d="/(app)/users/[id]/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(app)/users/[id]/page",pathname:"/users/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},6274:(e,r,t)=>{t.r(r),t.d(r,{default:()=>o});var s=t(9510),n=t(8585),i=t(7244),a=t(989);async function o({params:e}){let r=await (0,a.GA)(e.id);return r||(0,n.notFound)(),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-secondary-900",children:"Modifier l'utilisateur"}),s.jsx("p",{className:"text-secondary-600 mt-1",children:r.username})]}),s.jsx("div",{className:"bg-white shadow-md rounded-lg p-6",children:s.jsx(i.H,{user:r,mode:"edit"})})]})}},25:(e,r,t)=>{t.d(r,{IK:()=>c,ZO:()=>l});var s=t(8657);let n=null,i=process.env.COSMOS_DATABASE||"huronportal-db",a=null;async function o(){let e=function(){if(!n){let e=process.env.COSMOS_ENDPOINT,r=process.env.COSMOS_KEY;if(!e||!r)throw console.error("Cosmos DB configuration error:"),console.error("COSMOS_ENDPOINT:",e?"set":"missing"),console.error("COSMOS_KEY:",r?"set":"missing"),Error("COSMOS_ENDPOINT and COSMOS_KEY must be defined in environment variables");console.log("Initializing Cosmos DB client with endpoint:",e),n=new s.Pi({endpoint:e,key:r})}return n}();if(!a){let{database:r}=await e.databases.createIfNotExists({id:i});a=r}return a}let u={users:null,machines:null,clients:null};async function l(e){if(!u[e]){let r=await o(),{container:t}=await r.containers.createIfNotExists({id:e,partitionKey:{paths:[{users:"/username",machines:"/id",clients:"/id"}[e]]}});u[e]=t}return u[e]}function c(e){if(409===e.code)throw Error("DUPLICATE_ENTRY");if(404===e.code)throw Error("NOT_FOUND");if(412===e.code)throw Error("CONCURRENT_MODIFICATION");throw e}},989:(e,r,t)=>{t.d(r,{CX:()=>o,Cf:()=>p,GA:()=>u,Nq:()=>l,dQ:()=>a,h8:()=>c,r4:()=>i,yw:()=>d});var s=t(25),n=t(8547);async function i(e){try{let r=await (0,s.ZO)("users"),t=new Date().toISOString(),i={id:(0,n.Z)(),username:e.username,email:e.email,name:e.name,passwordHash:e.passwordHash,role:e.role,isActive:e.isActive,createdAt:t,updatedAt:t},{resource:a}=await r.items.create(i);return a}catch(e){return(0,s.IK)(e)}}async function a(e){try{let r=await (0,s.ZO)("users"),{resources:t}=await r.items.query({query:"SELECT * FROM users u WHERE u.username = @username",parameters:[{name:"@username",value:e}]}).fetchAll();return t[0]||null}catch(e){return console.error("Error fetching user:",e),null}}async function o(e){try{let r=await (0,s.ZO)("users"),{resources:t}=await r.items.query({query:"SELECT * FROM users u WHERE u.email = @email",parameters:[{name:"@email",value:e}]}).fetchAll();return t[0]||null}catch(e){return console.error("Error fetching user by email:",e),null}}async function u(e){try{let r=await (0,s.ZO)("users"),{resources:t}=await r.items.query({query:"SELECT * FROM users u WHERE u.id = @id",parameters:[{name:"@id",value:e}]}).fetchAll();return t[0]||null}catch(e){return console.error("Error fetching user by id:",e),null}}async function l(e,r,t,n){try{let i=await (0,s.ZO)("users"),a=await i.item(e,r).read();if(!a.resource)throw Error("NOT_FOUND");let o={...a.resource,...t,updatedAt:new Date().toISOString()},{resource:u}=await i.item(e,r).replace(o,n?{accessCondition:{type:"IfMatch",condition:n}}:void 0);if(!u)throw Error("NOT_FOUND");return u}catch(e){return(0,s.IK)(e)}}async function c(e,r){try{let t=await (0,s.ZO)("users");await t.item(e,r).delete()}catch(e){return(0,s.IK)(e)}}async function d(e){try{let r=await (0,s.ZO)("users"),t="SELECT * FROM users u WHERE 1=1",n=[];e?.role&&(t+=" AND u.role = @role",n.push({name:"@role",value:e.role})),e?.isActive!==void 0&&(t+=" AND u.isActive = @isActive",n.push({name:"@isActive",value:e.isActive}));let i={query:t+=" ORDER BY u.username",parameters:n},{resources:a}=await r.items.query(i).fetchAll();return a}catch(e){return console.error("Error listing users:",e),[]}}async function p(e,r){try{let t=await (0,s.ZO)("users"),n=await t.item(e,r).read();if(n.resource){let s={...n.resource,lastLogin:new Date().toISOString(),updatedAt:new Date().toISOString()};await t.item(e,r).replace(s)}}catch(e){console.error("Error updating last login:",e)}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,112,471,418,15,683,369],()=>t(1627));module.exports=s})();