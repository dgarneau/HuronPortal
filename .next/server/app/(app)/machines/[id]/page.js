"use strict";(()=>{var e={};e.id=564,e.ids=[564],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{e.exports=require("assert")},9714:e=>{e.exports=require("constants")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},4175:e=>{e.exports=require("tty")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},6005:e=>{e.exports=require("node:crypto")},8849:e=>{e.exports=require("node:http")},2286:e=>{e.exports=require("node:https")},612:e=>{e.exports=require("node:os")},7742:e=>{e.exports=require("node:process")},4492:e=>{e.exports=require("node:stream")},7261:e=>{e.exports=require("node:util")},5628:e=>{e.exports=require("node:zlib")},2317:(e,t,r)=>{r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>l}),r(1003),r(7210),r(5866),r(1506);var n=r(3191),a=r(8716),i=r(7922),o=r.n(i),s=r(5231),c={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>s[e]);r.d(t,c);let l=["",{children:["(app)",{children:["machines",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1003)),"C:\\GIT\\HuronPortal\\app\\(app)\\machines\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,7210)),"C:\\GIT\\HuronPortal\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"C:\\GIT\\HuronPortal\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\GIT\\HuronPortal\\app\\(app)\\machines\\[id]\\page.tsx"],d="/(app)/machines/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(app)/machines/[id]/page",pathname:"/machines/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},1003:(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});var n=r(9510),a=r(8585),i=r(8256),o=r(7956);async function s({params:e}){let t=await (0,o.Lg)(e.id);return t||(0,a.notFound)(),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900",children:"Modifier la machine"}),(0,n.jsxs)("p",{className:"text-secondary-600 mt-1",children:[t.numeroOL," - ",t.type]})]}),n.jsx("div",{className:"bg-white shadow-md rounded-lg p-6",children:n.jsx(i.i,{machine:t,mode:"edit"})})]})}},25:(e,t,r)=>{r.d(t,{IK:()=>u,ZO:()=>l});var n=r(8657);let a=null,i=process.env.COSMOS_DATABASE||"huronportal-db",o=null;async function s(){let e=function(){if(!a){let e=process.env.COSMOS_ENDPOINT,t=process.env.COSMOS_KEY;if(!e||!t)throw console.error("Cosmos DB configuration error:"),console.error("COSMOS_ENDPOINT:",e?"set":"missing"),console.error("COSMOS_KEY:",t?"set":"missing"),Error("COSMOS_ENDPOINT and COSMOS_KEY must be defined in environment variables");console.log("Initializing Cosmos DB client with endpoint:",e),a=new n.Pi({endpoint:e,key:t})}return a}();if(!o){let{database:t}=await e.databases.createIfNotExists({id:i});o=t}return o}let c={users:null,machines:null,clients:null};async function l(e){if(!c[e]){let t=await s(),{container:r}=await t.containers.createIfNotExists({id:e,partitionKey:{paths:[{users:"/username",machines:"/id",clients:"/id"}[e]]}});c[e]=r}return c[e]}function u(e){if(409===e.code)throw Error("DUPLICATE_ENTRY");if(404===e.code)throw Error("NOT_FOUND");if(412===e.code)throw Error("CONCURRENT_MODIFICATION");throw e}},5290:(e,t,r)=>{r.d(t,{EI:()=>d,Nu:()=>l,Qu:()=>c,eI:()=>o,mz:()=>s,pN:()=>u});var n=r(8547),a=r(25);let i="clients";async function o(e){let t=await (0,a.ZO)(i),r={id:(0,n.Z)(),companyName:e.companyName,address:e.address,province:e.province,postalCode:e.postalCode,machineCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{resource:o}=await t.items.create(r);return o}async function s(e){let t=await (0,a.ZO)(i);try{let{resource:r}=await t.item(e,e).read();return r||null}catch(e){if(404===e.code)return null;throw e}}async function c(e,t){let r=await (0,a.ZO)(i),{resource:n}=await r.item(e,e).read();if(!n)throw Error("Client not found");let o={...n,...t,updatedAt:new Date().toISOString()},{resource:s}=await r.item(e,e).replace(o);return s}async function l(e){let t=await (0,a.ZO)(i);await t.item(e,e).delete()}async function u(e=50,t){let r=(await (0,a.ZO)(i)).items.query("SELECT * FROM c ORDER BY c.companyName ASC",{maxItemCount:e,continuationToken:t}),{resources:n,continuationToken:o}=await r.fetchNext();return{clients:n,continuationToken:o}}async function d(e,t=50){let r=await (0,a.ZO)(i),n={query:"SELECT * FROM c WHERE CONTAINS(LOWER(c.companyName), @searchTerm) ORDER BY c.companyName ASC",parameters:[{name:"@searchTerm",value:e.toLowerCase()}]},{resources:o}=await r.items.query(n,{maxItemCount:t}).fetchAll();return o}},7956:(e,t,r)=>{r.d(t,{C8:()=>s,Lg:()=>c,Oq:()=>u,UF:()=>p,XV:()=>d,xw:()=>l});var n=r(8547),a=r(25),i=r(5290);let o="machines";async function s(e,t){let r=await (0,a.ZO)(o),s=await (0,i.mz)(e.clientId);if(!s)throw Error("Client not found");let c={id:(0,n.Z)(),numeroOL:e.numeroOL,type:e.type,clientId:e.clientId,clientName:s.companyName,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:t},{resource:l}=await r.items.create(c);return await (0,i.Qu)(e.clientId,{}),l}async function c(e){let t=await (0,a.ZO)(o);try{let{resource:r}=await t.item(e,e).read();return r||null}catch(e){if(404===e.code)return null;throw e}}async function l(e){let t=await (0,a.ZO)(o),{resources:r}=await t.items.query({query:"SELECT * FROM c WHERE c.numeroOL = @numeroOL",parameters:[{name:"@numeroOL",value:e}]}).fetchAll();return r.length>0?r[0]:null}async function u(e,t){let r=await (0,a.ZO)(o),{resource:n}=await r.item(e,e).read();if(!n)throw Error("Machine not found");let s=n.clientName;if(t.clientId&&t.clientId!==n.clientId){let e=await (0,i.mz)(t.clientId);if(!e)throw Error("Client not found");s=e.companyName}let c={...n,...t,clientName:s,updatedAt:new Date().toISOString()},{resource:l}=await r.item(e,e).replace(c);return l}async function d(e){let t=await (0,a.ZO)(o);await t.item(e,e).delete()}async function p(e=50,t,r){let n=await (0,a.ZO)(o),i="SELECT * FROM c",s=[],c=[];r?.clientId&&(c.push("c.clientId = @clientId"),s.push({name:"@clientId",value:r.clientId})),r?.numeroOL&&(c.push("CONTAINS(c.numeroOL, @numeroOL)"),s.push({name:"@numeroOL",value:r.numeroOL})),c.length>0&&(i+=" WHERE "+c.join(" AND ")),i+=" ORDER BY c.numeroOL ASC";let l=n.items.query({query:i,parameters:s},{maxItemCount:e,continuationToken:t}),{resources:u,continuationToken:d}=await l.fetchNext();return{machines:u,continuationToken:d}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,112,471,418,15,683,105],()=>r(2317));module.exports=n})();