(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571,935],{4645:function(e,r,s){Promise.resolve().then(s.bind(s,2766))},2766:function(e,r,s){"use strict";s.d(r,{UserForm:function(){return p}});var a=s(7437),t=s(9501),n=s(3590),i=s(9376),o=s(2265),l=s(914),c=s(8068),u=s(4226),d=s(4553);let m=[{value:"Admin",label:"Administrateur"},{value:"Contr\xf4leur",label:"Contr\xf4leur"},{value:"Utilisateur",label:"Utilisateur (lecture seule)"}];function p(e){var r,s,p,x;let{user:f,mode:v}=e,b=(0,i.useRouter)(),[h,y]=(0,o.useState)(!1),[g,N]=(0,o.useState)(""),{register:A,handleSubmit:L,formState:{errors:Z}}=(0,t.cI)({resolver:(0,n.F)("create"===v?l.J6:l.gV),defaultValues:f?{username:f.username,email:f.email,name:f.name,role:f.role,isActive:f.isActive}:{isActive:!0}}),_=async e=>{y(!0),N("");try{let r="create"===v?"/api/users":"/api/users/".concat(null==f?void 0:f.id),s="edit"===v?{email:e.email,name:e.name,role:e.role,isActive:e.isActive,...e.password&&{password:e.password}}:e,a=await fetch(r,{method:"create"===v?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json();throw Error(e.error||"Une erreur est survenue")}b.push("/users"),b.refresh()}catch(e){N(e instanceof Error?e.message:"Une erreur est survenue")}finally{y(!1)}};return(0,a.jsxs)("form",{onSubmit:L(_),noValidate:!0,className:"space-y-6 max-w-2xl",children:[g&&(0,a.jsx)(d.B,{children:g}),(0,a.jsx)(c.I,{label:"Nom complet",...A("name"),error:null===(r=Z.name)||void 0===r?void 0:r.message,disabled:h,placeholder:"Jean Tremblay"}),(0,a.jsx)(c.I,{label:"Courriel",type:"email",...A("email"),error:null===(s=Z.email)||void 0===s?void 0:s.message,disabled:h,placeholder:"jean.tremblay@exemple.com"}),(0,a.jsx)(c.I,{label:"Nom d'utilisateur",...A("username"),error:null===(p=Z.username)||void 0===p?void 0:p.message,disabled:h||"edit"===v,placeholder:"utilisateur.nom"}),(0,a.jsx)(c.I,{label:"create"===v?"Mot de passe":"Nouveau mot de passe (optionnel)",type:"password",...A("password"),error:null===(x=Z.password)||void 0===x?void 0:x.message,disabled:h,placeholder:"create"===v?"Minimum 8 caract\xe8res":"Laisser vide pour ne pas changer"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-secondary-700 mb-1",children:"R\xf4le"}),(0,a.jsxs)("select",{id:"role",...A("role"),disabled:h,className:"input-field",children:[(0,a.jsx)("option",{value:"",children:"S\xe9lectionnez un r\xf4le"}),m.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),Z.role&&(0,a.jsx)("p",{className:"mt-1 text-sm text-error-600",children:Z.role.message})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"isActive",type:"checkbox",...A("isActive"),disabled:h,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-secondary-300 rounded"}),(0,a.jsx)("label",{htmlFor:"isActive",className:"ml-2 block text-sm text-secondary-900",children:"Compte actif"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(u.z,{type:"submit",disabled:h,children:h?"Enregistrement...":"create"===v?"Cr\xe9er l'utilisateur":"Enregistrer"}),(0,a.jsx)(u.z,{type:"button",variant:"secondary",onClick:()=>b.push("/users"),disabled:h,children:"Annuler"})]})]})}},4226:function(e,r,s){"use strict";s.d(r,{z:function(){return t}});var a=s(7437);s(2265);let t=e=>{let{variant:r="primary",size:s="md",isLoading:t=!1,children:n,className:i="",disabled:o,...l}=e;return(0,a.jsx)("button",{className:"".concat("font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500 disabled:bg-primary-300",secondary:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 focus:ring-secondary-400 disabled:bg-secondary-100",danger:"bg-error-600 hover:bg-error-700 text-white focus:ring-error-500 disabled:bg-error-300"}[r]," ").concat({sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[s]," ").concat(i),disabled:o||t,...l,children:t?"Chargement...":n})}},4553:function(e,r,s){"use strict";s.d(r,{B:function(){return t}});var a=s(7437);s(2265);let t=e=>{let{children:r,className:s=""}=e;return r?(0,a.jsx)("div",{className:"bg-error-50 border border-error-200 text-error-700 px-4 py-3 rounded-md ".concat(s),role:"alert",children:(0,a.jsx)("p",{className:"text-sm",children:r})}):null}},8068:function(e,r,s){"use strict";s.d(r,{I:function(){return t}});var a=s(7437);let t=s(2265).forwardRef((e,r)=>{let{label:s,error:t,className:n="",id:i,...o}=e,l=i||"input-".concat(null==s?void 0:s.replace(/\s+/g,"-").toLowerCase());return(0,a.jsxs)("div",{className:"w-full",children:[s&&(0,a.jsx)("label",{htmlFor:l,className:"block text-sm font-medium text-secondary-700 mb-1",children:s}),(0,a.jsx)("input",{ref:r,id:l,className:"input-field ".concat(t?"border-error-500 focus:ring-error-500":""," ").concat(n),...o}),t&&(0,a.jsx)("p",{className:"mt-1 text-sm text-error-600",role:"alert",children:t})]})});t.displayName="Input"},914:function(e,r,s){"use strict";s.d(r,{Lf:function(){return U},dm:function(){return w},c5:function(){return O},J6:function(){return j},gV:function(){return C}});var a=s(7550);let t="Le mot de passe doit contenir au moins 8 caract\xe8res",n="Le mot de passe ne peut pas d\xe9passer 128 caract\xe8res",i="Le nom d'utilisateur doit contenir au moins 3 caract\xe8res",o="Le nom d'utilisateur ne peut pas d\xe9passer 50 caract\xe8res",l="Le nom d'utilisateur ne peut contenir que des lettres minuscules, chiffres, points, traits d'union et underscores",c="Le nom complet est requis",u="Le nom ne peut pas d\xe9passer 100 caract\xe8res",d="Adresse courriel invalide",m="Le courriel ne peut pas d\xe9passer 100 caract\xe8res",p="R\xf4le invalide. Choisir: Admin, Contr\xf4leur ou Utilisateur",x="Le num\xe9ro #OL est requis",f="Le num\xe9ro #OL ne peut pas d\xe9passer 50 caract\xe8res",v="Le num\xe9ro #OL ne peut contenir que des lettres majuscules, chiffres et tirets",b="Le type de machine est requis",h="Le type ne peut pas d\xe9passer 200 caract\xe8res",y="Client invalide",g="Le nom de l'entreprise est requis",N="Le nom de l'entreprise ne peut pas d\xe9passer 200 caract\xe8res",A="L'adresse est requise",L="L'adresse ne peut pas d\xe9passer 300 caract\xe8res",Z="Province invalide",_="Format de code postal invalide (A1A 1A1 ou A1A1A1)",j=a.Ryn({username:a.Z_8().min(3,i).max(50,o).regex(/^[a-z0-9._-]+$/,l),email:a.Z_8().min(1,"Le courriel est requis").email(d).max(100,m),name:a.Z_8().min(1,c).max(100,u),password:a.Z_8().min(8,t).max(128,n),role:a.KmV(["Admin","Contr\xf4leur","Utilisateur"],{message:p}),isActive:a.O72().default(!0)}),C=a.Ryn({username:a.Z_8().min(3,i).max(50,o).regex(/^[a-z0-9._-]+$/,l).optional(),email:a.Z_8().email(d).max(100,m).optional(),name:a.Z_8().min(1,c).max(100,u).optional(),password:a.Z_8().min(8,t).max(128,n).optional(),role:a.KmV(["Admin","Contr\xf4leur","Utilisateur"],{message:p}).optional(),isActive:a.O72().optional()}),w=a.Ryn({username:a.Z_8().min(1,"Le nom d'utilisateur ou courriel est requis"),password:a.Z_8().min(1,"Le mot de passe est requis")}),O=a.Ryn({numeroOL:a.Z_8().min(1,x).max(50,f).regex(/^[A-Z0-9-]+$/,v),type:a.Z_8().min(1,b).max(200,h),clientId:a.Z_8().uuid(y)});a.Ryn({numeroOL:a.Z_8().min(1,x).max(50,f).regex(/^[A-Z0-9-]+$/,v).optional(),type:a.Z_8().min(1,b).max(200,h).optional(),clientId:a.Z_8().uuid(y).optional()});let U=a.Ryn({companyName:a.Z_8().min(1,g).max(200,N),address:a.Z_8().min(1,A).max(300,L),province:a.KmV(["QC","ON","AB","BC","MB","NB","NL","NT","NS","NU","PE","SK","YT"],{message:Z}),postalCode:a.Z_8().regex(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,_).transform(e=>e.replace(/[ -]/g,"").toUpperCase())});a.Ryn({companyName:a.Z_8().min(1,g).max(200,N).optional(),address:a.Z_8().min(1,A).max(300,L).optional(),province:a.KmV(["QC","ON","AB","BC","MB","NB","NL","NT","NS","NU","PE","SK","YT"],{message:Z}).optional(),postalCode:a.Z_8().regex(/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/,_).transform(e=>e.replace(/[ -]/g,"").toUpperCase()).optional()})}},function(e){e.O(0,[832,971,117,744],function(){return e(e.s=4645)}),_N_E=e.O()}]);