(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[652],{2650:function(e,r,t){Promise.resolve().then(t.bind(t,768))},768:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return c}});var s=t(7437),n=t(2265),o=t(9376),a=t(2704),i=t(4226);function c(){let e=(0,o.useRouter)(),[r,t]=(0,n.useState)([]),[c,l]=(0,n.useState)([]),[d,u]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[m,x]=(0,n.useState)("");async function y(){try{u(!0);let e=await fetch("/api/clients?limit=100");if(!e.ok)throw Error("Erreur lors du chargement des clients");let r=await e.json();l(r.data||[]),t(r.data||[])}catch(e){h(e instanceof Error?e.message:"Une erreur est survenue")}finally{u(!1)}}async function f(e){if(confirm("\xcates-vous s\xfbr de vouloir supprimer ce client ?"))try{let r=await fetch("/api/clients/".concat(e),{method:"DELETE"});if(!r.ok){let e=await r.json();throw Error(e.error||"Erreur lors de la suppression")}y()}catch(e){alert(e instanceof Error?e.message:"Erreur lors de la suppression")}}return(0,n.useEffect)(()=>{y()},[]),(0,n.useEffect)(()=>{m?t(c.filter(e=>e.companyName.toLowerCase().includes(m.toLowerCase())||e.address.toLowerCase().includes(m.toLowerCase())||e.province.toLowerCase().includes(m.toLowerCase())||e.postalCode.toLowerCase().includes(m.toLowerCase()))):t(c)},[m,c]),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-secondary-900",children:"Gestion des clients"}),(0,s.jsx)("p",{className:"text-secondary-600 mt-1",children:"Liste de tous les clients enregistr\xe9s"})]}),(0,s.jsx)(i.z,{onClick:()=>e.push("/clients/new"),children:"Nouveau client"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-secondary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,s.jsx)("input",{type:"text",placeholder:"Rechercher par nom, adresse, province ou code postal...",value:m,onChange:e=>x(e.target.value),className:"input-field pl-10 w-full"})]}),p&&(0,s.jsx)("div",{className:"bg-error-50 border border-error-200 text-error-700 px-4 py-3 rounded-lg",children:p}),(0,s.jsx)(a._,{columns:[{key:"companyName",label:"Nom de l'entreprise"},{key:"address",label:"Adresse"},{key:"province",label:"Province"},{key:"postalCode",label:"Code postal"},{key:"machineCount",label:"Machines",render:e=>e.machineCount||0}],data:r,keyExtractor:e=>e.id,emptyMessage:"Aucun client enregistr\xe9",isLoading:d,actions:r=>(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsxs)("button",{onClick:()=>e.push("/clients/".concat(r.id)),className:"p-2 text-primary-600 hover:text-primary-700 hover:bg-primary-50 rounded transition-colors group relative",title:"Modifier",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,s.jsx)("span",{className:"absolute right-0 bottom-full mb-1 px-2 py-1 bg-secondary-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:"Modifier"})]}),(0,s.jsxs)("button",{onClick:()=>f(r.id),className:"p-2 text-error-600 hover:text-error-700 hover:bg-error-50 rounded transition-colors group relative",title:"Supprimer",children:[(0,s.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),(0,s.jsx)("span",{className:"absolute right-0 bottom-full mb-1 px-2 py-1 bg-secondary-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:"Supprimer"})]})]})})]})}},4226:function(e,r,t){"use strict";t.d(r,{z:function(){return n}});var s=t(7437);t(2265);let n=e=>{let{variant:r="primary",size:t="md",isLoading:n=!1,children:o,className:a="",disabled:i,...c}=e;return(0,s.jsx)("button",{className:"".concat("font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500 disabled:bg-primary-300",secondary:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 focus:ring-secondary-400 disabled:bg-secondary-100",danger:"bg-error-600 hover:bg-error-700 text-white focus:ring-error-500 disabled:bg-error-300"}[r]," ").concat({sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[t]," ").concat(a),disabled:i||n,...c,children:n?"Chargement...":o})}},2704:function(e,r,t){"use strict";t.d(r,{_:function(){return n}});var s=t(7437);function n(e){let{columns:r,data:t,keyExtractor:n,emptyMessage:o="Aucune donn\xe9e disponible",isLoading:a=!1,actions:i}=e;return a?(0,s.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):0===t.length?(0,s.jsx)("div",{className:"text-center py-12 bg-white rounded-lg border border-secondary-200",children:(0,s.jsx)("p",{className:"text-secondary-500 text-lg",children:o})}):(0,s.jsx)("div",{className:"bg-white rounded-lg border border-secondary-200 shadow-sm",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-secondary-200",children:[(0,s.jsx)("thead",{className:"bg-secondary-50 sticky top-0",children:(0,s.jsxs)("tr",{children:[r.map(e=>(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-700 uppercase tracking-wider",children:e.label},e.key)),i&&(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-secondary-700 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-secondary-200",children:t.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-secondary-50 transition-colors",children:[r.map(r=>{var t;return(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-secondary-900",children:r.render?r.render(e):String(null!==(t=e[r.key])&&void 0!==t?t:"")},r.key)}),i&&(0,s.jsx)("td",{className:"px-6 py-4 text-right text-sm font-medium",children:i(e)})]},n(e)))})]})})})}t(2265)},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2650)}),_N_E=e.O()}]);