(()=>{var e={};e.id=728,e.ids=[728],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7505:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),t(5035),t(7210),t(5866),t(1506);var s=t(3191),n=t(8716),a=t(7922),o=t.n(a),i=t(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let d=["",{children:["(app)",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5035)),"C:\\GIT\\HuronPortal\\app\\(app)\\users\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7210)),"C:\\GIT\\HuronPortal\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"C:\\GIT\\HuronPortal\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\GIT\\HuronPortal\\app\\(app)\\users\\page.tsx"],u="/(app)/users/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(app)/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6443:(e,r,t)=>{Promise.resolve().then(t.bind(t,247))},7976:()=>{},184:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},9902:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,9404,23))},247:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(326),n=t(7577),a=t(5047),o=t(3158),i=t(3679);function l(){let e=(0,a.useRouter)(),[r,t]=(0,n.useState)([]),[l,d]=(0,n.useState)([]),[c,u]=(0,n.useState)(!0),[p,m]=(0,n.useState)(null),[x,h]=(0,n.useState)("");async function y(){try{u(!0);let e=await fetch("/api/users");if(!e.ok)throw Error("Erreur lors du chargement des utilisateurs");let r=await e.json();d(r.data||[]),t(r.data||[])}catch(e){m(e instanceof Error?e.message:"Une erreur est survenue")}finally{u(!1)}}async function f(e){if(confirm("\xcates-vous s\xfbr de vouloir supprimer cet utilisateur ?"))try{let r=await fetch(`/api/users/${e}`,{method:"DELETE"});if(!r.ok){let e=await r.json();throw Error(e.error||"Erreur lors de la suppression")}y()}catch(e){alert(e instanceof Error?e.message:"Erreur lors de la suppression")}}return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-secondary-900",children:"Gestion des utilisateurs"}),s.jsx("p",{className:"text-secondary-600 mt-1",children:"G\xe9rer les comptes utilisateurs (Admin uniquement)"})]}),s.jsx(i.z,{onClick:()=>e.push("/users/new"),children:"Nouvel utilisateur"})]}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("svg",{className:"h-5 w-5 text-secondary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),s.jsx("input",{type:"text",placeholder:"Rechercher par nom, courriel, nom d'utilisateur ou r\xf4le...",value:x,onChange:e=>h(e.target.value),className:"input-field pl-10 w-full"})]}),p&&s.jsx("div",{className:"bg-error-50 border border-error-200 text-error-700 px-4 py-3 rounded-lg",children:p}),s.jsx(o._,{columns:[{key:"name",label:"Nom"},{key:"email",label:"Courriel"},{key:"username",label:"Nom d'utilisateur"},{key:"role",label:"R\xf4le"},{key:"isActive",label:"Statut",render:e=>s.jsx("span",{className:e.isActive?"text-success-600":"text-error-600",children:e.isActive?"Actif":"Inactif"})},{key:"lastLogin",label:"Derni\xe8re connexion",render:e=>e.lastLogin?new Date(e.lastLogin).toLocaleString("fr-CA"):"Jamais"},{key:"createdAt",label:"Date de cr\xe9ation",render:e=>new Date(e.createdAt).toLocaleDateString("fr-CA")}],data:r,keyExtractor:e=>e.id,emptyMessage:"Aucun utilisateur",isLoading:c,actions:r=>(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsxs)("button",{onClick:()=>e.push(`/users/${r.id}`),className:"p-2 text-primary-600 hover:text-primary-700 hover:bg-primary-50 rounded transition-colors group relative",title:"Modifier",children:[s.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s.jsx("span",{className:"absolute right-0 bottom-full mb-1 px-2 py-1 bg-secondary-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:"Modifier"})]}),(0,s.jsxs)("button",{onClick:()=>f(r.id),className:"p-2 text-error-600 hover:text-error-700 hover:bg-error-50 rounded transition-colors group relative",title:"Supprimer",children:[s.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),s.jsx("span",{className:"absolute right-0 bottom-full mb-1 px-2 py-1 bg-secondary-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:"Supprimer"})]})]})})]})}},3679:(e,r,t)=>{"use strict";t.d(r,{z:()=>n});var s=t(326);t(7577);let n=({variant:e="primary",size:r="md",isLoading:t=!1,children:n,className:a="",disabled:o,...i})=>s.jsx("button",{className:`font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500 disabled:bg-primary-300",secondary:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 focus:ring-secondary-400 disabled:bg-secondary-100",danger:"bg-error-600 hover:bg-error-700 text-white focus:ring-error-500 disabled:bg-error-300"}[e]} ${{sm:"py-1 px-3 text-sm",md:"py-2 px-4 text-base",lg:"py-3 px-6 text-lg"}[r]} ${a}`,disabled:o||t,...i,children:t?"Chargement...":n})},3158:(e,r,t)=>{"use strict";t.d(r,{_:()=>n});var s=t(326);function n({columns:e,data:r,keyExtractor:t,emptyMessage:n="Aucune donn\xe9e disponible",isLoading:a=!1,actions:o}){return a?s.jsx("div",{className:"flex justify-center items-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):0===r.length?s.jsx("div",{className:"text-center py-12 bg-white rounded-lg border border-secondary-200",children:s.jsx("p",{className:"text-secondary-500 text-lg",children:n})}):s.jsx("div",{className:"bg-white rounded-lg border border-secondary-200 shadow-sm",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-secondary-200",children:[s.jsx("thead",{className:"bg-secondary-50 sticky top-0",children:(0,s.jsxs)("tr",{children:[e.map(e=>s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-700 uppercase tracking-wider",children:e.label},e.key)),o&&s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-secondary-700 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-secondary-200",children:r.map(r=>(0,s.jsxs)("tr",{className:"hover:bg-secondary-50 transition-colors",children:[e.map(e=>s.jsx("td",{className:"px-6 py-4 text-sm text-secondary-900",children:e.render?e.render(r):String(r[e.key]??"")},e.key)),o&&s.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:o(r)})]},t(r)))})]})})})}t(7577)},5047:(e,r,t)=>{"use strict";var s=t(7389);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},7210:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(9510),n=t(8585),a=t(7371),o=t(1375);async function i({children:e}){let r=await (0,o.Gg)();r||(0,n.redirect)("/login");let t="Admin"===r.role;return"Admin"===r.role||r.role,(0,s.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[s.jsx("header",{className:"bg-white shadow-sm border-b border-secondary-200",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,s.jsxs)("div",{children:[s.jsx(a.default,{href:"/",className:"text-2xl font-bold text-primary-700 hover:text-primary-800",children:"Huron Portal"}),(0,s.jsxs)("p",{className:"text-sm text-secondary-600",children:["Bienvenue, ",r.username," (",r.role,")"]})]}),s.jsx("form",{action:"/api/auth/logout",method:"POST",children:s.jsx("button",{type:"submit",className:"bg-secondary-200 hover:bg-secondary-300 text-secondary-900 font-medium py-2 px-4 rounded-md transition-colors",children:"D\xe9connexion"})})]}),(0,s.jsxs)("nav",{className:"flex space-x-8 border-t border-secondary-200 pt-4 pb-4",children:[s.jsx(a.default,{href:"/",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Tableau de bord"}),s.jsx(a.default,{href:"/machines",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Machines"}),s.jsx(a.default,{href:"/clients",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Clients"}),t&&s.jsx(a.default,{href:"/users",className:"text-secondary-700 hover:text-primary-600 font-medium transition-colors",children:"Utilisateurs"})]})]})}),s.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})]})}},5035:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`C:\GIT\HuronPortal\app\(app)\users\page.tsx#default`)},1506:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a,metadata:()=>n});var s=t(9510);t(7272);let n={title:"Huron Portal - Gestion des Machines CNC",description:"Syst\xe8me de gestion des machines CNC pour Huron"};function a({children:e}){return s.jsx("html",{lang:"fr",children:s.jsx("body",{className:"antialiased bg-secondary-50 text-secondary-900",children:e})})}},1375:(e,r,t)=>{"use strict";t.d(r,{Gg:()=>p,Rf:()=>x,Uj:()=>m,ed:()=>d,v6:()=>u});var s=t(6890),n=t(1463),a=t(1615);let o=new TextEncoder().encode(process.env.SESSION_SECRET||"development-secret-key-change-in-production"),i=Number(process.env.SESSION_DURATION)||3600,l="session";async function d(e,r,t){let n=Math.floor(Date.now()/1e3),a=n+i;return await new s.N({userId:e,username:r,role:t,createdAt:n,expiresAt:a}).setProtectedHeader({alg:"HS256"}).setIssuedAt(n).setExpirationTime(a).sign(o)}async function c(e){try{let{payload:r}=await (0,n._)(e,o),t=Math.floor(Date.now()/1e3);if(r.expiresAt&&"number"==typeof r.expiresAt&&r.expiresAt<t)return null;return r}catch(e){return null}}async function u(e){let r=e.cookies.get(l)?.value;return r?c(r):null}async function p(){let e=await (0,a.cookies)(),r=e.get(l)?.value;return r?c(r):null}function m(e){return{name:l,value:e,httpOnly:!0,secure:!0,sameSite:"lax",maxAge:i,path:"/"}}function x(){return{name:l,value:"",httpOnly:!0,secure:!0,sameSite:"lax",maxAge:0,path:"/"}}},7272:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,112,471,15],()=>t(7505));module.exports=s})();